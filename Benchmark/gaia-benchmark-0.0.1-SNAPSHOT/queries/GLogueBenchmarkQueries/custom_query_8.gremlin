g.V().match(__.as('A').hasLabel('PERSON').in('KNOWS').as('B'), __.as('A').hasLabel('PERSON').in('HASCREATOR').hasLabel('COMMENT').as('C'), __.as('B').hasLabel('PERSON').in('HASCREATOR').hasLabel('COMMENT').as('D'), __.as('C').out('REPLYOF').as('D'), __.as('C').hasLabel('COMMENT').has('creationDate', lt($endDate).and(gt($startDate))).out('HASTAG').as('E'), __.as('D').hasLabel('COMMENT').out('HASTAG').as('E')).count()